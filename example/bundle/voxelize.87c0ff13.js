function e(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},a=n.parcelRequire4485;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,n){o[e]=n},n.parcelRequire4485=a),a("27Lyk").register(JSON.parse('{"3xzEA":"voxelize.87c0ff13.js","b4BBl":"generateAsync.worker.5bf93d10.js","j3wkH":"asyncGenerate.7b2d2b69.js","bEy7u":"asyncGenerate.6b6e94f2.js","5j17X":"characterMovement.24596860.js","q5Muf":"characterMovement.7f64fb29.js","1W1Zo":"characterMovement.f820c4cf.js","lAvTy":"characterMovement.de2f23a7.js","5hwZE":"asyncGenerate.81c67153.js","8jEbq":"clippedEdges.52da4c8b.js"}'));var i,d,r=a("ilwiq"),l=a("7lx9d"),s=a("kp7Te"),c={};i=c,d=function(){var e=function(){function n(e){return a.appendChild(e.dom),e}function t(e){for(var n=0;n<a.children.length;n++)a.children[n].style.display=n===e?"block":"none";o=e}var o=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",(function(e){e.preventDefault(),t(++o%a.children.length)}),!1);var i=(performance||Date).now(),d=i,r=0,l=n(new e.Panel("FPS","#0ff","#002")),s=n(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=n(new e.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:a,addPanel:n,showPanel:t,begin:function(){i=(performance||Date).now()},end:function(){r++;var e=(performance||Date).now();if(s.update(e-i,200),e>d+1e3&&(l.update(1e3*r/(e-d),100),d=e,r=0,c)){var n=performance.memory;c.update(n.usedJSHeapSize/1048576,n.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:a,setMode:t}};return e.Panel=function(e,n,t){var o=1/0,a=0,i=Math.round,d=i(window.devicePixelRatio||1),r=80*d,l=48*d,s=3*d,c=2*d,u=3*d,p=15*d,f=74*d,m=30*d,h=document.createElement("canvas");h.width=r,h.height=l,h.style.cssText="width:80px;height:48px";var w=h.getContext("2d");return w.font="bold "+9*d+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=t,w.fillRect(0,0,r,l),w.fillStyle=n,w.fillText(e,s,c),w.fillRect(u,p,f,m),w.fillStyle=t,w.globalAlpha=.9,w.fillRect(u,p,f,m),{dom:h,update:function(l,y){o=Math.min(o,l),a=Math.max(a,l),w.fillStyle=t,w.globalAlpha=1,w.fillRect(0,0,r,p),w.fillStyle=n,w.fillText(i(l)+" "+e+" ("+i(o)+"-"+i(a)+")",s,c),w.drawImage(h,u+d,p,f-d,m,u,p,f-d,m),w.fillRect(u+f-d,p,d,m),w.fillStyle=t,w.globalAlpha=.9,w.fillRect(u+f-d,p,d,i((1-l/y)*m))}}},e},"object"==typeof c?c=d():"function"==typeof define&&define.amd?define(d):i.Stats=d();var u=a("jiuw3"),p=a("4CEV9"),f=a("5Rd1x"),m=a("apoN1"),h=a("8todg");let w,y,b,g,x,M,v,B,S,j=!1,C=null;const E={model:"Torus Knot",scale:.75,resolution:30,solid:!0,displayMesh:!0,displayBounds:!1,insideOnly:!1,rebuild:()=>j=!0},R={};!function(){M=document.getElementById("output"),w=new r.WebGLRenderer({antialias:!0}),w.setPixelRatio(window.devicePixelRatio),w.setSize(window.innerWidth,window.innerHeight),w.setClearColor(1449501,1),w.outputEncoding=r.sRGBEncoding,document.body.appendChild(w.domElement),b=new r.Scene;const n=new r.DirectionalLight(16777215,1);n.position.set(3,6,9),b.add(n);const t=new r.DirectionalLight(16777215,.1);t.position.set(-3,-6,-9),b.add(t);const o=new r.AmbientLight(16777215,.25);b.add(o),y=new r.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50),y.position.set(1,.5,1),y.far=100,y.updateProjectionMatrix(),B=new f.OrbitControls(y,w.domElement),x=new(e(c)),document.body.appendChild(x.dom);const a=new r.MeshBasicMaterial({transparent:!0,wireframe:!0,depthWrite:!1,opacity:.02});(new l.GLTFLoader).setMeshoptDecoder(s.MeshoptDecoder).load("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/happy-buddha/buddha.glb",(e=>{const n=e.scene.children[0];n.geometry.center(),n.material=a,n.scale.setScalar(1.5),n.rotation.y=-Math.PI/2;(new h.GenerateMeshBVHWorker).generate(n.geometry).then((e=>{b.add(n),R.Buddha={model:n,bvh:e},"Buddha"===E.model&&(j=!0)}))})),(new l.GLTFLoader).setMeshoptDecoder(s.MeshoptDecoder).load("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/stanford-bunny/bunny.glb",(e=>{const n=e.scene.children[0];n.geometry.center(),n.material=a,n.rotation.y=Math.PI/2,n.scale.setScalar(.65);(new h.GenerateMeshBVHWorker).generate(n.geometry).then((e=>{b.add(n),R.Bunny={model:n,bvh:e},"Bunny"===E.model&&(j=!0)}))}));{const e=new r.Mesh(new r.TorusKnotGeometry(.3,.1,400,60),a),n=new p.MeshBVH(e.geometry);b.add(e),R["Torus Knot"]={bvh:n,model:e},j=!0}R.Buddha={model:null,bvh:null},R.Bunny={model:null,bvh:null};const i=new r.Mesh(new r.BoxGeometry);S=new r.BoxHelper(i,16777215),S.material.opacity=.35,S.material.transparent=!0,b.add(S),g=new u.GUI,g.add(E,"model",Object.keys(R)).onChange((()=>{j=!0}));const d=g.addFolder("voxelize");d.add(E,"resolution",5,75,1).onChange((()=>{j=!0})),d.add(E,"scale",.1,4).onChange((()=>{j=!0})),d.add(E,"solid").onChange((()=>{j=!0})),d.add(E,"insideOnly").onChange((()=>{j=!0})),d.add(E,"rebuild");const m=g.addFolder("helpers");m.add(E,"displayMesh"),m.add(E,"displayBounds"),window.addEventListener("resize",(function(){y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),w.setSize(window.innerWidth,window.innerHeight)}),!1)}(),function e(){x.update(),requestAnimationFrame(e),b.updateMatrixWorld(!0),j&&(C=function*(){const e=E.resolution,n=e**3,t=E.scale,o=t/e,a=new r.Color(16777215),i=new r.Color(16761095).convertSRGBToLinear();v&&v.instanceMatrix.count!==n&&(v.material.dispose(),v.dispose(),v.parent.remove(v),v=null);const{model:d,bvh:l}=R[E.model];if(!d)return;v||(v=new r.InstancedMesh(new m.RoundedBoxGeometry(1,1,1,4,.1),new r.MeshStandardMaterial,n),v.setColorAt(0,a),b.add(v));const s=-t/2+.5*o,c=new r.Vector3,u=new r.Quaternion,p=(new r.Vector3).setScalar(o),f=new r.Matrix4,h=new r.Box3,w=(new r.Matrix4).copy(d.matrixWorld).invert(),y=new r.Ray;y.direction.set(0,0,1);let g=0;for(let n=0;n<e;n++)for(let t=0;t<e;t++)for(let d=0;d<e;d++){c.set(s+t*o,s+n*o,s+d*o),h.min.setScalar(-.5*o).add(c),h.max.setScalar(.5*o).add(c);if(l.intersectsBox(h,w))E.insideOnly||(f.compose(c,u,p),v.setMatrixAt(g,f),v.setColorAt(g,a),v.instanceMatrix.needsUpdate=!0,v.instanceColor.needsUpdate=!0,g++);else if(E.solid){y.origin.copy(c).applyMatrix4(w);const e=l.raycastFirst(y,2);e&&e.face.normal.dot(y.direction)>0&&(f.compose(c,u,p),v.setMatrixAt(g,f),v.setColorAt(g,i),v.instanceMatrix.needsUpdate=!0,v.instanceColor.needsUpdate=!0,g++)}v.count=g,yield}v.count=g}(),j=!1);if(C){let e=window.performance.now();for(;window.performance.now()-e<16;){if(C.next().done){C=null;break}}}S&&(S.object.scale.setScalar(E.scale),S.object.updateMatrixWorld(!0),S.update());for(const e in R){const n=R[e];n.model&&(n.model.visible=!1)}const{model:n}=R[E.model];n&&(n.visible=E.displayMesh,S.visible=E.displayBounds);w.render(b,y)}();
//# sourceMappingURL=voxelize.87c0ff13.js.map
